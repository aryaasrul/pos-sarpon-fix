import{j as e,s as N}from"../assets/index-Xju1durr.js";import{r as s}from"./chunk-Dqgx_XrJ.js";import"./chunk-CqGYk7DY.js";import"./chunk-DsIAwHzQ.js";import"./chunk-nGiK0_2R.js";function M({isOpen:m,onClose:f,onSave:v,ingredient:t}){const[h,l]=s.useState(""),[r,c]=s.useState(""),[p,o]=s.useState("");s.useEffect(()=>{t?(l(t.name||""),c(t.purchase_price||""),o(t.pack_size_grams||"")):(l(""),c(""),o(""))},[t,m]);const g=n=>{n.preventDefault();const u={name:h,purchase_price:parseInt(r,10),pack_size_grams:parseInt(p,10)};v(u)};return m?e.jsx("div",{className:"modal-overlay",children:e.jsx("div",{className:"modal-content",children:e.jsxs("form",{onSubmit:g,children:[e.jsxs("h2",{children:[t?"Edit":"Tambah"," Bahan Baku"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nama Bahan (mis: Beans Pinara)"}),e.jsx("input",{type:"text",value:h,onChange:n=>l(n.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Harga Beli (Rp)"}),e.jsx("input",{type:"number",value:r,onChange:n=>c(n.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Ukuran Kemasan (gram)"}),e.jsx("input",{type:"number",value:p,onChange:n=>o(n.target.value),required:!0})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn-cancel",onClick:f,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})})}):null}function _({isOpen:m,onClose:f,onSave:v,menuItem:t}){const[h,l]=s.useState(""),[r,c]=s.useState(""),[p,o]=s.useState(""),[g,n]=s.useState("");s.useEffect(()=>{t?(l(t.name||""),c(t.fixed_cost||""),o(t.profit_margin||""),n(t.rounding_up||"")):(l(""),c("1600"),o("0.5"),n("500"))},[t,m]);const u=i=>{i.preventDefault();const b={name:h,fixed_cost:parseInt(r,10),profit_margin:parseFloat(p),rounding_up:parseInt(g,10)};v(b)};return m?e.jsx("div",{className:"modal-overlay",children:e.jsx("div",{className:"modal-content",children:e.jsxs("form",{onSubmit:u,children:[e.jsxs("h2",{children:[t?"Edit":"Tambah"," Menu Jualan"]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Nama Menu (mis: Manual Brew)"}),e.jsx("input",{type:"text",value:h,onChange:i=>l(i.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Biaya Tetap (Rp)"}),e.jsx("input",{type:"number",value:r,onChange:i=>c(i.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Margin Profit (contoh: 0.5 untuk 50%)"}),e.jsx("input",{type:"number",step:"0.01",value:p,onChange:i=>o(i.target.value),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Pembulatan Harga (contoh: 500)"}),e.jsx("input",{type:"number",step:"100",value:g,onChange:i=>n(i.target.value),required:!0})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",className:"btn-cancel",onClick:f,children:"Batal"}),e.jsx("button",{type:"submit",className:"btn-save",children:"Simpan"})]})]})})}):null}function D(){const[m,f]=s.useState([]),[v,t]=s.useState([]),[h,l]=s.useState(!0),[r,c]=s.useState("ingredients"),[p,o]=s.useState(!1),[g,n]=s.useState(!1),[u,i]=s.useState(null),b=async()=>{l(!0);try{const{data:a,error:x}=await N.from("ingredients").select("*");if(x)throw x;f(a);const{data:d,error:j}=await N.from("menu_items").select("*");if(j)throw j;t(d)}catch{}finally{l(!1)}};s.useEffect(()=>{b()},[]);const S=(a=null)=>{i(a),r==="ingredients"?o(!0):n(!0)},k=()=>{o(!1),n(!1),i(null)},y=async a=>{const x=r==="ingredients"?"ingredients":"menu_items";let d;if(u){const{error:j}=await N.from(x).update(a).eq("id",u.id);d=j}else{const{error:j}=await N.from(x).insert([a]);d=j}d?alert(d.message):(k(),b())},C=async a=>{if(window.confirm(`Yakin ingin menghapus "${a.name}"?`)){const x=r==="ingredients"?"ingredients":"menu_items",{error:d}=await N.from(x).delete().eq("id",a.id);d?alert(d.message):b()}};return e.jsxs("div",{className:"katalog-page",children:[e.jsxs("div",{className:"katalog-header",children:[e.jsx("h1",{children:"Katalog"}),e.jsxs("button",{onClick:()=>S(),className:"btn-add-product",children:[e.jsx("img",{src:"/icons/icon-plus-input-manual.svg",alt:"Tambah"}),e.jsxs("span",{children:["Tambah ",r==="ingredients"?"Bahan Baku":"Menu"]})]})]}),e.jsxs("div",{className:"tab-container",style:{marginBottom:"20px"},children:[e.jsx("button",{className:`tab-btn ${r==="ingredients"?"active":""}`,onClick:()=>c("ingredients"),children:"Bahan Baku"}),e.jsx("button",{className:`tab-btn ${r==="menuItems"?"active":""}`,onClick:()=>c("menuItems"),children:"Menu Jualan"})]}),h&&e.jsx("div",{children:"Memuat data..."}),e.jsx("div",{className:"katalog-grid",children:r==="ingredients"?m.map(a=>e.jsxs("div",{className:"katalog-card",children:[e.jsxs("div",{className:"katalog-card-details",children:[e.jsx("h3",{children:a.name}),e.jsxs("p",{children:["Rp ",a.purchase_price.toLocaleString("id-ID")," / ",a.pack_size_grams,"g"]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>S(a),style:{marginRight:"10px"},children:"Edit"}),e.jsx("button",{onClick:()=>C(a),children:"Hapus"})]})]},a.id)):v.map(a=>e.jsxs("div",{className:"katalog-card",children:[e.jsxs("div",{className:"katalog-card-details",children:[e.jsx("h3",{children:a.name}),e.jsxs("p",{children:["Biaya Tetap: Rp ",a.fixed_cost.toLocaleString("id-ID")]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>S(a),style:{marginRight:"10px"},children:"Edit"}),e.jsx("button",{onClick:()=>C(a),children:"Hapus"})]})]},a.id))}),e.jsx(M,{isOpen:p,onClose:k,onSave:y,ingredient:u}),e.jsx(_,{isOpen:g,onClose:k,onSave:y,menuItem:u})]})}export{D as default};
